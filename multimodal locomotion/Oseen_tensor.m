function [X,A,B]=Oseen_tensor(r0_l,r1_l,r2_l,phi1,phi2,theta1,theta2,F1n_l,F1t_l,F2n_l,F2t_l,v_orbit1,v_orbit2,mu,Ra1,Rb1,Ra2,Rb2,R1ns,R2ns,a1,a2,a0,c1,c2)

    rgam0=1/(6*pi*mu*a0);
    rgam1=1/(6*pi*mu*a1);
    rgam2=1/(6*pi*mu*a2);

% compute G (6)
    [G01]=three_stokeslets_3D(r0_l(1),r0_l(2),r0_l(3),r1_l(1),r1_l(2),r1_l(3),mu);
    [G10]=three_stokeslets_3D(r1_l(1),r1_l(2),r1_l(3),r0_l(1),r0_l(2),r0_l(3),mu);
    [G02]=three_stokeslets_3D(r0_l(1),r0_l(2),r0_l(3),r2_l(1),r2_l(2),r2_l(3),mu);
    [G20]=three_stokeslets_3D(r2_l(1),r2_l(2),r2_l(3),r0_l(1),r0_l(2),r0_l(3),mu);
    [G12]=three_stokeslets_3D(r1_l(1),r1_l(2),r1_l(3),r2_l(1),r2_l(2),r2_l(3),mu);
    [G21]=three_stokeslets_3D(r2_l(1),r2_l(2),r2_l(3),r1_l(1),r1_l(2),r1_l(3),mu);


% define A, X, B and solve
    A=zeros(21,21);
    B=zeros(21,1);

    phi11=atan2(sin(phi1)*Ra1,cos(phi1)*Rb1);
    phi22=atan2(sin(phi2)*Ra2,cos(phi2)*Rb2);
    R1=sqrt(Ra1*Ra1*cos(phi11)*cos(phi11) + Rb1*Rb1*sin(phi11)*sin(phi11));
    R2=sqrt(Ra2*Ra2*cos(phi22)*cos(phi22) + Rb2*Rb2*sin(phi22)*sin(phi22));

    F1t=1+c1*cos(phi1+theta1);
    F2t=1+c2*cos(phi2+theta2);
% value of dr/dtheta
    i1=mod(phi1,2*pi)/pi*180+1;
    i2=mod(phi2,2*pi)/pi*180+1;
    i1=round(i1);
    i2=round(i2);

    if i1==361
       i1=1;
    end
    if i2==361
       i2=1;
    end
% the 1st row
  A(1,3) = (r1_l(3)-r0_l(3))*F1n_l(2) - (r1_l(2)-r0_l(2))*F1n_l(3);
  A(1,4) =-(r1_l(3)-r0_l(3))*F1n_l(1) + (r1_l(1)-r0_l(1))*F1n_l(3);
  A(1,5) = (r1_l(2)-r0_l(2))*F1n_l(1) - (r1_l(1)-r0_l(1))*F1n_l(2);
  A(1,6) = -R1ns(i1);
  A(1,11) = 1;
  A(1,15) = -F1n_l(1);
  A(1,16) = -F1n_l(2);
  A(1,17) = -F1n_l(3);

% the 2nd row
  A(2,3) = (r1_l(3)-r0_l(3))*F1t_l(2) - (r1_l(2)-r0_l(2))*F1t_l(3);
  A(2,4) =-(r1_l(3)-r0_l(3))*F1t_l(1) + (r1_l(1)-r0_l(1))*F1t_l(3);
  A(2,5) = (r1_l(2)-r0_l(2))*F1t_l(1) - (r1_l(1)-r0_l(1))*F1t_l(2);
  A(2,6) = -R1;
  A(2,12) = 1;
  A(2,15) = -F1t_l(1);
  A(2,16) = -F1t_l(2);
  A(2,17) = -F1t_l(3);

% the 3rd row
  A(3,3) = (r2_l(3)-r0_l(3))*F2n_l(2) - (r2_l(2)-r0_l(2))*F2n_l(3);
  A(3,4) =-(r2_l(3)-r0_l(3))*F2n_l(1) + (r2_l(1)-r0_l(1))*F2n_l(3);
  A(3,5) = (r2_l(2)-r0_l(2))*F2n_l(1) - (r2_l(1)-r0_l(1))*F2n_l(2);
  A(3,7) = -R2ns(i2);
  A(3,13) = 1;
  A(3,15) = -F2n_l(1);
  A(3,16) = -F2n_l(2);
  A(3,17) = -F2n_l(3);

% the 4th row
  A(4,3) = (r2_l(3)-r0_l(3))*F2t_l(2) - (r2_l(2)-r0_l(2))*F2t_l(3);
  A(4,4) =-(r2_l(3)-r0_l(3))*F2t_l(1) + (r2_l(1)-r0_l(1))*F2t_l(3);
  A(4,5) = (r2_l(2)-r0_l(2))*F2t_l(1) - (r2_l(1)-r0_l(1))*F2t_l(2);
  A(4,7) = -R2;
  A(4,14) = 1;
  A(4,15) = -F2t_l(1);
  A(4,16) = -F2t_l(2);
  A(4,17) = -F2t_l(3);

% the 5th row
  A(5,1) = -(G01(1,1)*F1n_l(1)+G01(1,2)*F1n_l(2)+G01(1,3)*F1n_l(3)-rgam0*F1n_l(1));
  A(5,2) = -(G02(1,1)*F2n_l(1)+G02(1,2)*F2n_l(2)+G02(1,3)*F2n_l(3)-rgam0*F2n_l(1));
  A(5,15) = 1;
  A(5,18) = -(G01(1,1)*v_orbit1(1)+G01(1,2)*v_orbit1(2)+G01(1,3)*v_orbit1(3)-rgam0*v_orbit1(1));
  A(5,19) = -(G02(1,1)*v_orbit2(1)+G02(1,2)*v_orbit2(2)+G02(1,3)*v_orbit2(3)-rgam0*v_orbit2(1));

  B(5,1) = G01(1,1)*F1t*F1t_l(1)+G01(1,2)*F1t*F1t_l(2)+G01(1,3)*F1t*F1t_l(3)-rgam0*F1t*F1t_l(1)+...
           G02(1,1)*F2t*F2t_l(1)+G02(1,2)*F2t*F2t_l(2)+G02(1,3)*F2t*F2t_l(3)-rgam0*F2t*F2t_l(1);

% the 6th row
  A(6,1) = -(G01(2,1)*F1n_l(1)+G01(2,2)*F1n_l(2)+G01(2,3)*F1n_l(3)-rgam0*F1n_l(2));
  A(6,2) = -(G02(2,1)*F2n_l(1)+G02(2,2)*F2n_l(2)+G02(2,3)*F2n_l(3)-rgam0*F2n_l(2));
  A(6,16) = 1;
  A(6,18) = -(G01(2,1)*v_orbit1(1)+G01(2,2)*v_orbit1(2)+G01(2,3)*v_orbit1(3)-rgam0*v_orbit1(2));
  A(6,19) = -(G02(2,1)*v_orbit2(1)+G02(2,2)*v_orbit2(2)+G02(2,3)*v_orbit2(3)-rgam0*v_orbit2(2));

  B(6,1) = G01(2,1)*F1t*F1t_l(1)+G01(2,2)*F1t*F1t_l(2)+G01(2,3)*F1t*F1t_l(3)-rgam0*F1t*F1t_l(2)+...
           G02(2,1)*F2t*F2t_l(1)+G02(2,2)*F2t*F2t_l(2)+G02(2,3)*F2t*F2t_l(3)-rgam0*F2t*F2t_l(2);

% the 7th row
  A(7,1) = -(G01(3,1)*F1n_l(1)+G01(3,2)*F1n_l(2)+G01(3,3)*F1n_l(3)-rgam0*F1n_l(3));
  A(7,2) = -(G02(3,1)*F2n_l(1)+G02(3,2)*F2n_l(2)+G02(3,3)*F2n_l(3)-rgam0*F2n_l(3));
  A(7,17) = 1;
  A(7,18) = -(G01(3,1)*v_orbit1(1)+G01(3,2)*v_orbit1(2)+G01(3,3)*v_orbit1(3)-rgam0*v_orbit1(3));
  A(7,19) = -(G02(3,1)*v_orbit2(1)+G02(3,2)*v_orbit2(2)+G02(3,3)*v_orbit2(3)-rgam0*v_orbit2(3));

  B(7,1) = G01(3,1)*F1t*F1t_l(1)+G01(3,2)*F1t*F1t_l(2)+G01(3,3)*F1t*F1t_l(3)-rgam0*F1t*F1t_l(3)+...
           G02(3,1)*F2t*F2t_l(1)+G02(3,2)*F2t*F2t_l(2)+G02(3,3)*F2t*F2t_l(3)-rgam0*F2t*F2t_l(3);

% the 8th row
  A(8,1) = -rgam1 + (G10(1,1)*F1n_l(1)+G10(1,2)*F1n_l(2)+G10(1,3)*F1n_l(3))*F1n_l(1)+...
                    (G10(2,1)*F1n_l(1)+G10(2,2)*F1n_l(2)+G10(2,3)*F1n_l(3))*F1n_l(2)+...
                    (G10(3,1)*F1n_l(1)+G10(3,2)*F1n_l(2)+G10(3,3)*F1n_l(3))*F1n_l(3);
  A(8,2) = -((G12(1,1)-G10(1,1))*F2n_l(1)+(G12(1,2)-G10(1,2))*F2n_l(2)+(G12(1,3)-G10(1,3))*F2n_l(3))*F1n_l(1)-...
            ((G12(2,1)-G10(2,1))*F2n_l(1)+(G12(2,2)-G10(2,2))*F2n_l(2)+(G12(2,3)-G10(2,3))*F2n_l(3))*F1n_l(2)-...
            ((G12(3,1)-G10(3,1))*F2n_l(1)+(G12(3,2)-G10(3,2))*F2n_l(2)+(G12(3,3)-G10(3,3))*F2n_l(3))*F1n_l(3);
  A(8,11) = 1;
  A(8,18) = (G10(1,1)*v_orbit1(1)+G10(1,2)*v_orbit1(2)+G10(1,3)*v_orbit1(3))*F1n_l(1)+...
            (G10(2,1)*v_orbit1(1)+G10(2,2)*v_orbit1(2)+G10(2,3)*v_orbit1(3))*F1n_l(2)+...
            (G10(3,1)*v_orbit1(1)+G10(3,2)*v_orbit1(2)+G10(3,3)*v_orbit1(3))*F1n_l(3);
  A(8,19)= -((G12(1,1)-G10(1,1))*v_orbit2(1)+(G12(1,2)-G10(1,2))*v_orbit2(2)+(G12(1,3)-G10(1,3))*v_orbit2(3))*F1n_l(1)-...
            ((G12(2,1)-G10(2,1))*v_orbit2(1)+(G12(2,2)-G10(2,2))*v_orbit2(2)+(G12(2,3)-G10(2,3))*v_orbit2(3))*F1n_l(2)-...
            ((G12(3,1)-G10(3,1))*v_orbit2(1)+(G12(3,2)-G10(3,2))*v_orbit2(2)+(G12(3,3)-G10(3,3))*v_orbit2(3))*F1n_l(3);

  B(8,1) =  ((G12(1,1)-G10(1,1))*F2t*F2t_l(1)+(G12(1,2)-G10(1,2))*F2t*F2t_l(2)+(G12(1,3)-G10(1,3))*F2t*F2t_l(3))*F1n_l(1)+...
            ((G12(2,1)-G10(2,1))*F2t*F2t_l(1)+(G12(2,2)-G10(2,2))*F2t*F2t_l(2)+(G12(2,3)-G10(2,3))*F2t*F2t_l(3))*F1n_l(2)+...
            ((G12(3,1)-G10(3,1))*F2t*F2t_l(1)+(G12(3,2)-G10(3,2))*F2t*F2t_l(2)+(G12(3,3)-G10(3,3))*F2t*F2t_l(3))*F1n_l(3)-...
            (G10(1,1)*F1t*F1t_l(1)+G10(1,2)*F1t*F1t_l(2)+G10(1,3)*F1t*F1t_l(3))*F1n_l(1)-...
            (G10(2,1)*F1t*F1t_l(1)+G10(2,2)*F1t*F1t_l(2)+G10(2,3)*F1t*F1t_l(3))*F1n_l(2)-...
            (G10(3,1)*F1t*F1t_l(1)+G10(3,2)*F1t*F1t_l(2)+G10(3,3)*F1t*F1t_l(3))*F1n_l(3);

% the 9th row
  A(9,1) =  (G10(1,1)*F1n_l(1)+G10(1,2)*F1n_l(2)+G10(1,3)*F1n_l(3))*F1t_l(1)+...
            (G10(2,1)*F1n_l(1)+G10(2,2)*F1n_l(2)+G10(2,3)*F1n_l(3))*F1t_l(2)+...
            (G10(3,1)*F1n_l(1)+G10(3,2)*F1n_l(2)+G10(3,3)*F1n_l(3))*F1t_l(3);
  A(9,2) = -((G12(1,1)-G10(1,1))*F2n_l(1)+(G12(1,2)-G10(1,2))*F2n_l(2)+(G12(1,3)-G10(1,3))*F2n_l(3))*F1t_l(1)-...
            ((G12(2,1)-G10(2,1))*F2n_l(1)+(G12(2,2)-G10(2,2))*F2n_l(2)+(G12(2,3)-G10(2,3))*F2n_l(3))*F1t_l(2)-...
            ((G12(3,1)-G10(3,1))*F2n_l(1)+(G12(3,2)-G10(3,2))*F2n_l(2)+(G12(3,3)-G10(3,3))*F2n_l(3))*F1t_l(3);
  A(9,12) = 1;
  A(9,18) = (G10(1,1)*v_orbit1(1)+G10(1,2)*v_orbit1(2)+G10(1,3)*v_orbit1(3))*F1t_l(1)+...
            (G10(2,1)*v_orbit1(1)+G10(2,2)*v_orbit1(2)+G10(2,3)*v_orbit1(3))*F1t_l(2)+...
            (G10(3,1)*v_orbit1(1)+G10(3,2)*v_orbit1(2)+G10(3,3)*v_orbit1(3))*F1t_l(3);
  A(9,19)= -((G12(1,1)-G10(1,1))*v_orbit2(1)+(G12(1,2)-G10(1,2))*v_orbit2(2)+(G12(1,3)-G10(1,3))*v_orbit2(3))*F1t_l(1)-...
            ((G12(2,1)-G10(2,1))*v_orbit2(1)+(G12(2,2)-G10(2,2))*v_orbit2(2)+(G12(2,3)-G10(2,3))*v_orbit2(3))*F1t_l(2)-...
            ((G12(3,1)-G10(3,1))*v_orbit2(1)+(G12(3,2)-G10(3,2))*v_orbit2(2)+(G12(3,3)-G10(3,3))*v_orbit2(3))*F1t_l(3);

  B(9,1) =  ((G12(1,1)-G10(1,1))*F2t*F2t_l(1)+(G12(1,2)-G10(1,2))*F2t*F2t_l(2)+(G12(1,3)-G10(1,3))*F2t*F2t_l(3))*F1t_l(1)+...
            ((G12(2,1)-G10(2,1))*F2t*F2t_l(1)+(G12(2,2)-G10(2,2))*F2t*F2t_l(2)+(G12(2,3)-G10(2,3))*F2t*F2t_l(3))*F1t_l(2)+...
            ((G12(3,1)-G10(3,1))*F2t*F2t_l(1)+(G12(3,2)-G10(3,2))*F2t*F2t_l(2)+(G12(3,3)-G10(3,3))*F2t*F2t_l(3))*F1t_l(3)-...
            (G10(1,1)*F1t*F1t_l(1)+G10(1,2)*F1t*F1t_l(2)+G10(1,3)*F1t*F1t_l(3))*F1t_l(1)-...
            (G10(2,1)*F1t*F1t_l(1)+G10(2,2)*F1t*F1t_l(2)+G10(2,3)*F1t*F1t_l(3))*F1t_l(2)-...
            (G10(3,1)*F1t*F1t_l(1)+G10(3,2)*F1t*F1t_l(2)+G10(3,3)*F1t*F1t_l(3))*F1t_l(3)+...
            rgam1*F1t;

% the 10th row
  A(10,1) = -((G21(1,1)-G20(1,1))*F1n_l(1)+(G21(1,2)-G20(1,2))*F1n_l(2)+(G21(1,3)-G20(1,3))*F1n_l(3))*F2n_l(1)-...
             ((G21(2,1)-G20(2,1))*F1n_l(1)+(G21(2,2)-G20(2,2))*F1n_l(2)+(G21(2,3)-G20(2,3))*F1n_l(3))*F2n_l(2)-...
             ((G21(3,1)-G20(3,1))*F1n_l(1)+(G21(3,2)-G20(3,2))*F1n_l(2)+(G21(3,3)-G20(3,3))*F1n_l(3))*F2n_l(3);
  A(10,2) = -rgam2 + (G20(1,1)*F2n_l(1)+G20(1,2)*F2n_l(2)+G20(1,3)*F2n_l(3))*F2n_l(1)+...
                     (G20(2,1)*F2n_l(1)+G20(2,2)*F2n_l(2)+G20(2,3)*F2n_l(3))*F2n_l(2)+...
                     (G20(3,1)*F2n_l(1)+G20(3,2)*F2n_l(2)+G20(3,3)*F2n_l(3))*F2n_l(3);
  A(10,13) = 1;
  A(10,18)= -((G21(1,1)-G20(1,1))*v_orbit1(1)+(G21(1,2)-G20(1,2))*v_orbit1(2)+(G21(1,3)-G20(1,3))*v_orbit1(3))*F2n_l(1)-...
             ((G21(2,1)-G20(2,1))*v_orbit1(1)+(G21(2,2)-G20(2,2))*v_orbit1(2)+(G21(2,3)-G20(2,3))*v_orbit1(3))*F2n_l(2)-...
             ((G21(3,1)-G20(3,1))*v_orbit1(1)+(G21(3,2)-G20(3,2))*v_orbit1(2)+(G21(3,3)-G20(3,3))*v_orbit1(3))*F2n_l(3);
  A(10,19) = (G20(1,1)*v_orbit2(1)+G20(1,2)*v_orbit2(2)+G20(1,3)*v_orbit2(3))*F2n_l(1)+...
             (G20(2,1)*v_orbit2(1)+G20(2,2)*v_orbit2(2)+G20(2,3)*v_orbit2(3))*F2n_l(2)+...
             (G20(3,1)*v_orbit2(1)+G20(3,2)*v_orbit2(2)+G20(3,3)*v_orbit2(3))*F2n_l(3);

  B(10,1) =  ((G21(1,1)-G20(1,1))*F1t*F1t_l(1)+(G21(1,2)-G20(1,2))*F1t*F1t_l(2)+(G21(1,3)-G20(1,3))*F1t*F1t_l(3))*F2n_l(1)+...
             ((G21(2,1)-G20(2,1))*F1t*F1t_l(1)+(G21(2,2)-G20(2,2))*F1t*F1t_l(2)+(G21(2,3)-G20(2,3))*F1t*F1t_l(3))*F2n_l(2)+...
             ((G21(3,1)-G20(3,1))*F1t*F1t_l(1)+(G21(3,2)-G20(3,2))*F1t*F1t_l(2)+(G21(3,3)-G20(3,3))*F1t*F1t_l(3))*F2n_l(3)-...
             (G20(1,1)*F2t*F2t_l(1)+G20(1,2)*F2t*F2t_l(2)+G20(1,3)*F2t*F2t_l(3))*F2n_l(1)-...
             (G20(2,1)*F2t*F2t_l(1)+G20(2,2)*F2t*F2t_l(2)+G20(2,3)*F2t*F2t_l(3))*F2n_l(2)-...
             (G20(3,1)*F2t*F2t_l(1)+G20(3,2)*F2t*F2t_l(2)+G20(3,3)*F2t*F2t_l(3))*F2n_l(3);

% the 11th row
  A(11,1) = -((G21(1,1)-G20(1,1))*F1n_l(1)+(G21(1,2)-G20(1,2))*F1n_l(2)+(G21(1,3)-G20(1,3))*F1n_l(3))*F2t_l(1)-...
             ((G21(2,1)-G20(2,1))*F1n_l(1)+(G21(2,2)-G20(2,2))*F1n_l(2)+(G21(2,3)-G20(2,3))*F1n_l(3))*F2t_l(2)-...
             ((G21(3,1)-G20(3,1))*F1n_l(1)+(G21(3,2)-G20(3,2))*F1n_l(2)+(G21(3,3)-G20(3,3))*F1n_l(3))*F2t_l(3);
  A(11,2) =  (G20(1,1)*F2n_l(1)+G20(1,2)*F2n_l(2)+G20(1,3)*F2n_l(3))*F2t_l(1)+...
             (G20(2,1)*F2n_l(1)+G20(2,2)*F2n_l(2)+G20(2,3)*F2n_l(3))*F2t_l(2)+...
             (G20(3,1)*F2n_l(1)+G20(3,2)*F2n_l(2)+G20(3,3)*F2n_l(3))*F2t_l(3);
  A(11,14) = 1;
  A(11,18)= -((G21(1,1)-G20(1,1))*v_orbit1(1)+(G21(1,2)-G20(1,2))*v_orbit1(2)+(G21(1,3)-G20(1,3))*v_orbit1(3))*F2t_l(1)-...
             ((G21(2,1)-G20(2,1))*v_orbit1(1)+(G21(2,2)-G20(2,2))*v_orbit1(2)+(G21(2,3)-G20(2,3))*v_orbit1(3))*F2t_l(2)-...
             ((G21(3,1)-G20(3,1))*v_orbit1(1)+(G21(3,2)-G20(3,2))*v_orbit1(2)+(G21(3,3)-G20(3,3))*v_orbit1(3))*F2t_l(3);
  A(11,19)=  (G20(1,1)*v_orbit2(1)+G20(1,2)*v_orbit2(2)+G20(1,3)*v_orbit2(3))*F2t_l(1)+...
             (G20(2,1)*v_orbit2(1)+G20(2,2)*v_orbit2(2)+G20(2,3)*v_orbit2(3))*F2t_l(2)+...
             (G20(3,1)*v_orbit2(1)+G20(3,2)*v_orbit2(2)+G20(3,3)*v_orbit2(3))*F2t_l(3);

  B(11,1) =  ((G21(1,1)-G20(1,1))*F1t*F1t_l(1)+(G21(1,2)-G20(1,2))*F1t*F1t_l(2)+(G21(1,3)-G20(1,3))*F1t*F1t_l(3))*F2t_l(1)+...
             ((G21(2,1)-G20(2,1))*F1t*F1t_l(1)+(G21(2,2)-G20(2,2))*F1t*F1t_l(2)+(G21(2,3)-G20(2,3))*F1t*F1t_l(3))*F2t_l(2)+...
             ((G21(3,1)-G20(3,1))*F1t*F1t_l(1)+(G21(3,2)-G20(3,2))*F1t*F1t_l(2)+(G21(3,3)-G20(3,3))*F1t*F1t_l(3))*F2t_l(3)-...
             (G20(1,1)*F2t*F2t_l(1)+G20(1,2)*F2t*F2t_l(2)+G20(1,3)*F2t*F2t_l(3))*F2t_l(1)-...
             (G20(2,1)*F2t*F2t_l(1)+G20(2,2)*F2t*F2t_l(2)+G20(2,3)*F2t*F2t_l(3))*F2t_l(2)-...
             (G20(3,1)*F2t*F2t_l(1)+G20(3,2)*F2t*F2t_l(2)+G20(3,3)*F2t*F2t_l(3))*F2t_l(3)+...
             rgam2*F2t;

% the 12th row
  A(12,1) = F1n_l(1);
  A(12,2) = F2n_l(1);
  A(12,8) = 1;
  A(12,18) = v_orbit1(1);
  A(12,19) = v_orbit2(1);

  B(12,1) = -F1t*F1t_l(1) - F2t*F2t_l(1);

% the 13th row
  A(13,1) = F1n_l(2);
  A(13,2) = F2n_l(2);
  A(13,9) = 1;
  A(13,18) = v_orbit1(2);
  A(13,19) = v_orbit2(2);

  B(13,1) = -F1t*F1t_l(2) - F2t*F2t_l(2);

% the 14th row
  A(14,1) = F1n_l(3);
  A(14,2) = F2n_l(3);
  A(14,10) = 1;
  A(14,18) = v_orbit1(3);
  A(14,19) = v_orbit2(3);

  B(14,1) = -F1t*F1t_l(3) - F2t*F2t_l(3);

% the 15th row
  A(15,1) = (r1_l(2)-r0_l(2))*F1n_l(3)-(r1_l(3)-r0_l(3))*F1n_l(2);
  A(15,2) = (r2_l(2)-r0_l(2))*F2n_l(3)-(r2_l(3)-r0_l(3))*F2n_l(2);
  A(15,3) = 8*pi*mu*a0*a0*a0;
  A(15,18)= (r1_l(2)-r0_l(2))*v_orbit1(3)-(r1_l(3)-r0_l(3))*v_orbit1(2);
  A(15,19)= (r2_l(2)-r0_l(2))*v_orbit2(3)-(r2_l(3)-r0_l(3))*v_orbit2(2);

  B(15,1) = -((r1_l(2)-r0_l(2))*F1t*F1t_l(3)-(r1_l(3)-r0_l(3))*F1t*F1t_l(2))-...
             ((r2_l(2)-r0_l(2))*F2t*F2t_l(3)-(r2_l(3)-r0_l(3))*F2t*F2t_l(2));

% the 16th row
  A(16,1) = (r1_l(3)-r0_l(3))*F1n_l(1)-(r1_l(1)-r0_l(1))*F1n_l(3);
  A(16,2) = (r2_l(3)-r0_l(3))*F2n_l(1)-(r2_l(1)-r0_l(1))*F2n_l(3);
  A(16,4) = 8*pi*mu*a0*a0*a0;
  A(16,18)= (r1_l(3)-r0_l(3))*v_orbit1(1)-(r1_l(1)-r0_l(1))*v_orbit1(3);
  A(16,19)= (r2_l(3)-r0_l(3))*v_orbit2(1)-(r2_l(1)-r0_l(1))*v_orbit2(3);

  B(16,1) = -((r1_l(3)-r0_l(3))*F1t*F1t_l(1)-(r1_l(1)-r0_l(1))*F1t*F1t_l(3))-...
             ((r2_l(3)-r0_l(3))*F2t*F2t_l(1)-(r2_l(1)-r0_l(1))*F2t*F2t_l(3));

% the 17th row
  A(17,1) = (r1_l(1)-r0_l(1))*F1n_l(2)-(r1_l(2)-r0_l(2))*F1n_l(1);
  A(17,2) = (r2_l(1)-r0_l(1))*F2n_l(2)-(r2_l(2)-r0_l(2))*F2n_l(1);
  A(17,5) = 8*pi*mu*a0*a0*a0;
  A(17,18)= (r1_l(1)-r0_l(1))*v_orbit1(2)-(r1_l(2)-r0_l(2))*v_orbit1(1);
  A(17,19)= (r2_l(1)-r0_l(1))*v_orbit2(2)-(r2_l(2)-r0_l(2))*v_orbit2(1);

  B(17,1) = -((r1_l(1)-r0_l(1))*F1t*F1t_l(2)-(r1_l(2)-r0_l(2))*F1t*F1t_l(1))-...
             ((r2_l(1)-r0_l(1))*F2t*F2t_l(2)-(r2_l(2)-r0_l(2))*F2t*F2t_l(1));

% the 18th row
  A(18,3) = (r1_l(3)-r0_l(3))*v_orbit1(2) - (r1_l(2)-r0_l(2))*v_orbit1(3);
  A(18,4) =-(r1_l(3)-r0_l(3))*v_orbit1(1) + (r1_l(1)-r0_l(1))*v_orbit1(3);
  A(18,5) = (r1_l(2)-r0_l(2))*v_orbit1(1) - (r1_l(1)-r0_l(1))*v_orbit1(2);
  A(18,15) = -v_orbit1(1);
  A(18,16) = -v_orbit1(2);
  A(18,17) = -v_orbit1(3);
  A(18,20) = 1;

% the 19th row
  A(19,3) = (r2_l(3)-r0_l(3))*v_orbit2(2) - (r2_l(2)-r0_l(2))*v_orbit2(3);
  A(19,4) =-(r2_l(3)-r0_l(3))*v_orbit2(1) + (r2_l(1)-r0_l(1))*v_orbit2(3);
  A(19,5) = (r2_l(2)-r0_l(2))*v_orbit2(1) - (r2_l(1)-r0_l(1))*v_orbit2(2);
  A(19,15) = -v_orbit2(1);
  A(19,16) = -v_orbit2(2);
  A(19,17) = -v_orbit2(3);
  A(19,21) = 1;

% the 20th row
  A(20,1) = (G10(1,1)*F1n_l(1)+G10(1,2)*F1n_l(2)+G10(1,3)*F1n_l(3))*v_orbit1(1)+...
            (G10(2,1)*F1n_l(1)+G10(2,2)*F1n_l(2)+G10(2,3)*F1n_l(3))*v_orbit1(2)+...
            (G10(3,1)*F1n_l(1)+G10(3,2)*F1n_l(2)+G10(3,3)*F1n_l(3))*v_orbit1(3);
  A(20,2) = -((G12(1,1)-G10(1,1))*F2n_l(1)+(G12(1,2)-G10(1,2))*F2n_l(2)+(G12(1,3)-G10(1,3))*F2n_l(3))*v_orbit1(1)-...
             ((G12(2,1)-G10(2,1))*F2n_l(1)+(G12(2,2)-G10(2,2))*F2n_l(2)+(G12(2,3)-G10(2,3))*F2n_l(3))*v_orbit1(2)-...
             ((G12(3,1)-G10(3,1))*F2n_l(1)+(G12(3,2)-G10(3,2))*F2n_l(2)+(G12(3,3)-G10(3,3))*F2n_l(3))*v_orbit1(3);
  A(20,18) = -rgam1 + (G10(1,1)*v_orbit1(1)+G10(1,2)*v_orbit1(2)+G10(1,3)*v_orbit1(3))*v_orbit1(1)+...
                      (G10(2,1)*v_orbit1(1)+G10(2,2)*v_orbit1(2)+G10(2,3)*v_orbit1(3))*v_orbit1(2)+...
                      (G10(3,1)*v_orbit1(1)+G10(3,2)*v_orbit1(2)+G10(3,3)*v_orbit1(3))*v_orbit1(3);
  A(20,19)= -((G12(1,1)-G10(1,1))*v_orbit2(1)+(G12(1,2)-G10(1,2))*v_orbit2(2)+(G12(1,3)-G10(1,3))*v_orbit2(3))*v_orbit1(1)-...
             ((G12(2,1)-G10(2,1))*v_orbit2(1)+(G12(2,2)-G10(2,2))*v_orbit2(2)+(G12(2,3)-G10(2,3))*v_orbit2(3))*v_orbit1(2)-...
             ((G12(3,1)-G10(3,1))*v_orbit2(1)+(G12(3,2)-G10(3,2))*v_orbit2(2)+(G12(3,3)-G10(3,3))*v_orbit2(3))*v_orbit1(3);
  A(20,20) = 1;
 
  B(20,1) = ((G12(1,1)-G10(1,1))*F2t*F2t_l(1)+(G12(1,2)-G10(1,2))*F2t*F2t_l(2)+(G12(1,3)-G10(1,3))*F2t*F2t_l(3))*v_orbit1(1)+...
            ((G12(2,1)-G10(2,1))*F2t*F2t_l(1)+(G12(2,2)-G10(2,2))*F2t*F2t_l(2)+(G12(2,3)-G10(2,3))*F2t*F2t_l(3))*v_orbit1(2)+...
            ((G12(3,1)-G10(3,1))*F2t*F2t_l(1)+(G12(3,2)-G10(3,2))*F2t*F2t_l(2)+(G12(3,3)-G10(3,3))*F2t*F2t_l(3))*v_orbit1(3)-...
            (G10(1,1)*F1t*F1t_l(1)+G10(1,2)*F1t*F1t_l(2)+G10(1,3)*F1t*F1t_l(3))*v_orbit1(1)-...
            (G10(2,1)*F1t*F1t_l(1)+G10(2,2)*F1t*F1t_l(2)+G10(2,3)*F1t*F1t_l(3))*v_orbit1(2)-...
            (G10(3,1)*F1t*F1t_l(1)+G10(3,2)*F1t*F1t_l(2)+G10(3,3)*F1t*F1t_l(3))*v_orbit1(3);

% the 21th row
  A(21,1) = -((G21(1,1)-G20(1,1))*F1n_l(1)+(G21(1,2)-G20(1,2))*F1n_l(2)+(G21(1,3)-G20(1,3))*F1n_l(3))*v_orbit2(1)-...
             ((G21(2,1)-G20(2,1))*F1n_l(1)+(G21(2,2)-G20(2,2))*F1n_l(2)+(G21(2,3)-G20(2,3))*F1n_l(3))*v_orbit2(2)-...
             ((G21(3,1)-G20(3,1))*F1n_l(1)+(G21(3,2)-G20(3,2))*F1n_l(2)+(G21(3,3)-G20(3,3))*F1n_l(3))*v_orbit2(3);
  A(21,2) =  (G20(1,1)*F2n_l(1)+G20(1,2)*F2n_l(2)+G20(1,3)*F2n_l(3))*v_orbit2(1)+...
             (G20(2,1)*F2n_l(1)+G20(2,2)*F2n_l(2)+G20(2,3)*F2n_l(3))*v_orbit2(2)+...
             (G20(3,1)*F2n_l(1)+G20(3,2)*F2n_l(2)+G20(3,3)*F2n_l(3))*v_orbit2(3);
  A(21,18)= -((G21(1,1)-G20(1,1))*v_orbit1(1)+(G21(1,2)-G20(1,2))*v_orbit1(2)+(G21(1,3)-G20(1,3))*v_orbit1(3))*v_orbit2(1)-...
             ((G21(2,1)-G20(2,1))*v_orbit1(1)+(G21(2,2)-G20(2,2))*v_orbit1(2)+(G21(2,3)-G20(2,3))*v_orbit1(3))*v_orbit2(2)-...
             ((G21(3,1)-G20(3,1))*v_orbit1(1)+(G21(3,2)-G20(3,2))*v_orbit1(2)+(G21(3,3)-G20(3,3))*v_orbit1(3))*v_orbit2(3);
  A(21,19) = -rgam2 + (G20(1,1)*v_orbit2(1)+G20(1,2)*v_orbit2(2)+G20(1,3)*v_orbit2(3))*v_orbit2(1)+...
                      (G20(2,1)*v_orbit2(1)+G20(2,2)*v_orbit2(2)+G20(2,3)*v_orbit2(3))*v_orbit2(2)+...
                      (G20(3,1)*v_orbit2(1)+G20(3,2)*v_orbit2(2)+G20(3,3)*v_orbit2(3))*v_orbit2(3);
  A(21,21) = 1;

  B(21,1) =  ((G21(1,1)-G20(1,1))*F1t*F1t_l(1)+(G21(1,2)-G20(1,2))*F1t*F1t_l(2)+(G21(1,3)-G20(1,3))*F1t*F1t_l(3))*v_orbit2(1)+...
             ((G21(2,1)-G20(2,1))*F1t*F1t_l(1)+(G21(2,2)-G20(2,2))*F1t*F1t_l(2)+(G21(2,3)-G20(2,3))*F1t*F1t_l(3))*v_orbit2(2)+...
             ((G21(3,1)-G20(3,1))*F1t*F1t_l(1)+(G21(3,2)-G20(3,2))*F1t*F1t_l(2)+(G21(3,3)-G20(3,3))*F1t*F1t_l(3))*v_orbit2(3)-...
             (G20(1,1)*F2t*F2t_l(1)+G20(1,2)*F2t*F2t_l(2)+G20(1,3)*F2t*F2t_l(3))*v_orbit2(1)-...
             (G20(2,1)*F2t*F2t_l(1)+G20(2,2)*F2t*F2t_l(2)+G20(2,3)*F2t*F2t_l(3))*v_orbit2(2)-...
             (G20(3,1)*F2t*F2t_l(1)+G20(3,2)*F2t*F2t_l(2)+G20(3,3)*F2t*F2t_l(3))*v_orbit2(3);

% slove
  X=A\B;

    F1n=X(1);
    F2n=X(2);
    wx=X(3);
    wy=X(4);
    wz=X(5);
    dphi1=X(6);
    dphi2=X(7);
    F0x=X(8);
    F0y=X(9);
    F0z=X(10);
    v1n=X(11);
    v1t=X(12);
    v2n=X(13);
    v2t=X(14);
    v0x=X(15);
    v0y=X(16);
    v0z=X(17);
    F1p=X(18);
    F2p=X(19);
    v1p=X(20);
    v2p=X(21);
end